{
    "collab_server" : "",
    "contents" : "#\"2018-12-06 21:20:56 PST\"\nrm(list=ls())\ndata <- read.csv('all.csv')\ndata <- data[,2:11]\n\nlibrary(Hmisc)\nlibrary(pheatmap)\nres <- rcorr(as.matrix(data))\npdf('Correlation_plot.pdf',onefile = T)\npheatmap(res$r,\n         col = colorRampPalette(c(\"#3399FF\",\"white\",\"red\"))(100),\n         cluster_rows = T,cluster_cols=T,\n         clustering_distance_rows = 'correlation',clustering_distance_cols = 'correlation',\n         treeheight_row = 80,treeheight_col = 80,\n         display_numbers = T,number_color = 'black',fontsize_number = 10,\n         border_color = NA,legend=TRUE,\n         show_colnames=T,show_rownames=T,\n         fontsize_col = 10, \n         fontsize_row = 10,fontsize = 10,\n         main = 'Correlation')\n\nlibrary(corrplot)\ncorrplot(res$r,col = colorRampPalette(c(\"blue\",\"white\",\"red\"))(100),\n         type='full',order='hclust',tl.col = \"black\", \n         diag=T,outline = T,bg = 'white',addgrid.col = 'black',\n         addCoef.col = 'black',tl.cex = 1,\n         p.mat = res$P,sig.level = 0.01,insig = 'blank',\n         number.digits = 2)\n\nsymnum(res$r)\n\ndev.off()\n\n\n\n#还可以通过层次聚类来查看样本之间的关系：\nnames_cluster <- data.frame(sample=colnames(data),group=c(rep('FK',5),rep('HN',5)))\n#如果group是factor,要转化成character\nnames_cluster$group <- as.character(names_cluster$group)\n#合并出来新名称，这样能同时看到样本名字和分组信息\nnames_cluster$new_names <- paste(names_cluster$sample,names_cluster$group,sep = \"_\")\n#查看对应关系是否正确，应该是正确的。\nnames_cluster\ncolnames(data)\n#对矩阵的名字进行替换\ncolnames(data) <- names_cluster$new_names\ncolnames(data)\n#然后进行聚类\ndistance <- dist(t(data),method=\"euclidean\")\nclusters <- hclust(distance,method = \"complete\")\npdf(\"sample_cluster.pdf\")\npar(mar = c(5, 5, 5, 3))#图的下，左，上，右到页面的边距\npar(mgp = c(1.5, 0.5, 0))\nplot(clusters)\ndev.off()",
    "created" : 1544159475426.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2636301051",
    "id" : "E051DDA6",
    "lastKnownWriteTime" : 1544160446,
    "last_content_update" : 1544160446270,
    "path" : "H:/Github/BGI/Correlation_Cluster.R",
    "project_path" : "Correlation_Cluster.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}
theme_bw()+ theme(axis.text.y = element_text(size = rel(1.3)),
axis.title.x = element_text(size=rel(2.3)), axis.title.y = element_blank() )
ggplot(tmp,aes(x=GeneRatio,y=Description))+
geom_point(aes(size=Count,color=qvalue))+
scale_colour_gradient(low="blue",high="red")+
labs( color=expression(qvalue),
x="Gene Ratio",y="Pathway name", title="Pathway enrichment")+
theme_bw()+ theme(axis.text.y = element_text(size = rel(1)),
axis.title.x = element_text(size=rel(1)), axis.title.y = element_blank() )
ggplot(tmp,aes(x=GeneRatio,y=Description))+
geom_point(aes(size=Count,color=qvalue))+
scale_colour_gradient(low="blue",high="red")+
labs( color=expression(qvalue),
x="Gene Ratio",y="Pathway name", title="Pathway enrichment")+
theme(axis.text.y = element_text(size = rel(1)),
axis.title.x = element_text(size=rel(1)),
axis.title.y = element_blank() )
ggplot(tmp,aes(x=GeneRatio,y=Description))+
geom_point(aes(size=Count,color=qvalue))+
scale_colour_gradient(low="blue",high="red")+
labs( color=expression(qvalue),
x="Gene Ratio",y="Pathway name", title="Pathway enrichment")+
theme_minimal()+
theme(axis.text.y = element_text(size = rel(1)),
axis.title.x = element_text(size=rel(1)),
axis.title.y = element_blank() )
ggplot(tmp,aes(x=GeneRatio,y=Description))+
geom_point(aes(size=Count,color=qvalue))+
scale_colour_gradient(low="blue",high="red")+
labs( color=expression(qvalue),
x="Gene Ratio",y="Pathway name", title="Pathway enrichment")+
theme_bw()+
theme(axis.text.y = element_text(size = rel(1)),
axis.title.x = element_text(size=rel(1)),
axis.title.y = element_blank() )
#or plot using ggplot2
tmp <- kk@result[kk@result$qvalue<0.01,]
library(ggplot2)
ggplot(tmp,aes(x=GeneRatio,y=Description))+
geom_point(aes(size=Count,color=qvalue))+
scale_colour_gradient(low="blue",high="red")+
scale_x_continuous()+
labs( color=expression(qvalue),
x="Gene Ratio",y="Pathway name", title="Pathway enrichment")+
theme_bw()+
theme(axis.text.y = element_text(size = rel(1)),
axis.title.x = element_text(size=rel(1)),
axis.title.y = element_blank() )
range(tmp$GeneRatio)
str(tmp)
tmp$GeneRatio <- as.numeric(tmp$GeneRatio)
#or plot using ggplot2
tmp <- kk@result[kk@result$qvalue<0.01,]
ggplot(tmp,aes(x=GeneRatio,y=Description))+
geom_point(aes(size=Count,color=qvalue))+
scale_colour_gradient(low="blue",high="red")+
scale_x_continuous()+
labs( color=expression(qvalue), x="Gene Ratio",
y="Pathway name", title="Pathway enrichment")+
theme_bw()+
theme(axis.text.y = element_text(size = rel(1)),
axis.title.x = element_text(size=rel(1)),
axis.title.y = element_blank() )
ggplot(tmp,aes(x=GeneRatio,y=Description))+
geom_point(aes(size=Count,color=qvalue))+
scale_colour_gradient(low="blue",high="red")+
labs( color=expression(qvalue), x="Gene Ratio",
y="Pathway name", title="Pathway enrichment")+
theme_bw()+
theme(axis.text.y = element_text(size = rel(1)),
axis.title.x = element_text(size=rel(1)),
axis.title.y = element_blank() )
str(tmp)
tmp[1,3]
tmp[1,3]%>%str_split(pattern = '/')
library(clusterProfiler)
library(org.Hs.eg.db)
library(enrichplot)
library(pathview)
library(stringr)
library(dplyr)
library(DOSE)
library(ggplot2)
library(magrittr)
tmp[1,3]%>%str_split(pattern = '/')
tmp[1,3]%>%str_split(pattern = '/')%>%unlist()
tmp[1,3]%>%str_split(pattern = '/')%>%unlist()%>%divide_by()
tmp[1,3]%>%str_split(pattern = '/')%>%unlist()%>%divide_by()
tmp[1,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric()%>%divide_by()
class(tmp[1,3]%>%str_split(pattern = '/')%>%unlist())
class(tmp[1,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric())
tmp[1,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric()
class(tmp[1,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric())
str(tmp[1,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric())
tmp[1,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric()%>%divide_by()
a <- tmp[1,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric()
divide_by(a)
a
divide_by(a[1],a[2])
a <- tmp[1,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric()%>%divide_by([1],[2])
library(magrittr)
nrow(tmp)
tmp
c <- vector()
c
tmp <- kk@result[kk@result$qvalue<0.01,]
Char2Num <- function(i) {
tmp1 <- tmp[i,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric()
tmp2 <- divide_by(a[1],a[2])
return(b)
}
tmp3 <- vector()
for (i in 1:nrow(tmp)) {
tmp4 <- Char2Num(i)
tmp3 <- c(tmp3,tmp4)
}
tmp <- kk@result[kk@result$qvalue<0.01,]
Char2Num <- function(i) {
tmp1 <- tmp[i,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric()
tmp2 <- divide_by(a[1],a[2])
return(tmp2)
}
tmp3 <- vector()
for (i in 1:nrow(tmp)) {
tmp4 <- Char2Num(i)
tmp3 <- c(tmp3,tmp4)
}
tmp3
tmp1 <- tmp[2,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric()
tmp <- kk@result[kk@result$qvalue<0.01,]
Char2Num <- function(i) {
tmp1 <- tmp[2,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric()
tmp2 <- divide_by(tmp1[1],tmp1[2])
return(tmp2)
}
tmp3 <- vector()
for (i in 1:nrow(tmp)) {
tmp4 <- Char2Num(i)
tmp3 <- c(tmp3,tmp4)
}
tmp3
tmp <- kk@result[kk@result$qvalue<0.01,]
Char2Num <- function(i) {
tmp1 <- tmp[i,3]%>%str_split(pattern = '/')%>%unlist()%>%as.numeric()
tmp2 <- divide_by(tmp1[1],tmp1[2])
return(tmp2)
}
tmp3 <- vector()
for (i in 1:nrow(tmp)) {
tmp4 <- Char2Num(i)
tmp3 <- c(tmp3,tmp4)
}
tmp3
36/540
42//540
42/540
str(tmp3)
tmp$GeneRatio <- tmp3
str(tmp)
#将generatio由字符转化为数值
head(tmp)
#将generatio由字符转化为数值
str(tmp)
ggplot(tmp,aes(x=GeneRatio,y=Description))+
geom_point(aes(size=Count,color=qvalue))+
scale_colour_gradient(low="blue",high="red")+
scale_x_continuous()+
labs( color=expression(qvalue), x="Gene Ratio",
y="Pathway name", title="Pathway enrichment")+
theme_bw()+
theme(axis.text.y = element_text(size = rel(1)),
axis.title.x = element_text(size=rel(1)),
axis.title.y = element_blank() )
read.csv('interested pathways_genes_DQC.csv')
data <- read.csv('interested pathways_genes_DQC.csv')
View(data)
write.table(data$Other.Gene.ID,'gene_DQC.txt',quote = F,sep = '\t',
row.names = F,col.names = F)
data <- read.csv('interested pathways_genes_DQC.csv')
write.table(data$Other.Gene.ID,'gene_DQC.txt',quote = F,sep = '\t',
row.names = F,col.names = F)
data <- read.csv('gene_PPI_input.txt')
upgene_in_FK <- read.csv('up_genes_in_FK.csv')
View(upgene_in_FK)
write.table(upgene_in_FK$Other.Gene.ID,'up_genes_in_FK.csv',
quote = F,sep = '\t',col.names = F,row.names = F)
write.table(upgene_in_FK$Gene.ID,'up_genes_in_FK.csv',
quote = F,sep = '\t',col.names = F,row.names = F)
upgene_in_FK <- read.csv('PPI_input_up_in_HN')
upgene_in_FK <- read.csv('PPI_input_up_in_HN.csv')
data <- read.csv('PPI_input_up_in_HN.csv')
write.table(data$ï..Gene.ID,'up_genes_in_FK.csv',
quote = F,sep = '\t',col.names = F,row.names = F)
data <- read.csv('PPI_input_down_in_HN.csv')
write.table(data$ï..Gene.ID,'up_genes_in_FK.csv',
quote = F,sep = '\t',col.names = F,row.names = F)
write.table(data$ï..Gene.ID,'PPI_input_down_in_HN.csv',
quote = F,sep = '\t',col.names = F,row.names = F)
data <- read.csv('PPI_input_down_HN.csv')
write.table(data$ï..Gene.ID,'PPI_input_down_HN.csv',
quote = F,sep = '\t',col.names = F,row.names = F)
data <- read.csv('PPI_inpu_up_HN.csv')
write.table(data$ï..Gene.ID,'PPI_inpu_up_HN.csv',
quote = F,sep = '\t',col.names = F,row.names = F)
data <- read.csv('PPI_input_down_HN.csv')
write.table(data$ï..Gene.ID,'PPI_input_down_HN.csv',
quote = F,sep = '\t',col.names = F,row.names = F)
data <- read.csv('up.csv')
View(data)
a <- read.csv('PPI_input_up_HN.csv')
a
cat(a,sep = '\t')
str(a)
cat(a$X100129583,sep = '\t')
read.delim('GSEA_ranked_gene_list.txt',header = T,row.names = F,sep = '\t')
read.delim('GSEA_ranked_gene_list.txt',header = T,sep = '\t')
b <- read.delim('GSEA_ranked_gene_list.txt',header = T,sep = '\t')
View(b)
18537-200
c <- b[-201:28337,]
c <- b[-c(201:28337),]
View(c)
c <- b[-c(201:28337),]
b <- read.delim('GSEA_ranked_gene_list.txt',header = T,sep = '\t')
c <- b[-c(201:18337),]
c <- c$NAME
c
gene <- c$NAME
b <- read.delim('GSEA_ranked_gene_list.txt',header = T,sep = '\t')
c <- b[-c(201:18337),]
gene <- c$NAME
b <- read.delim('GSEA_ranked_gene_list.txt',header = T,sep = '\t')
c <- b[-c(201:18337),]
gene <- c$NAME
exprs <- read.csv('all.csv')
View(exprs)
colnames(exprs)
exprs <- exprs[,c(2:10)]
b <- read.delim('GSEA_ranked_gene_list.txt',header = T,sep = '\t')
gene <- b[-c(201:18337),]
View(gene)
colnames(gene)
data_heatmap <- merge(exprs,gene,by.x = 'Other.Gene.ID',by.y = 'NAME',all = F)
View(data_heatmap)
colnames(data_heatmap
colnames(data_heatmap)
data_heatmap <- data_heatmap[,1:9]
rownames(data_heatmap)<-data_heatmap$Other.Gene.ID
data_heatmap <- data_heatmap[,-1]
colnames(data_heatmap)
colnames(data_heatmap)<-c('FK2','FK4','FK5',paste0(rep('HN',5),1:5))
library(pheatmap)
library(RColorBrewer)
pdf("heatmap.pdf",width = 20,height = 5,onefile = T)
install.packages('pheatmap')
library(pheatmap)
library(RColorBrewer)
pdf("heatmap.pdf",width = 20,height = 5,onefile = T)
dev.off()
dev.off()
dev.off()
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 2,
fontsize_row = 8,fontsize = 8,
main = 'Heatmap')
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 1,fontsize = 8,
main = 'TOP200(UP/DOWN)')
pdf("heatmap.pdf",width = 7,height = 20,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 1,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
dev.off()
dev.off()
pdf("heatmap.pdf",width = 7,height = 20,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 1,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
pdf("heatmap.pdf",width = 7,height = 20,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 2,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
pdf("heatmap.pdf",width = 7,height = 20,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 3,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
png("heatmap.png",width = 7,height = 20)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 3,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
png("heatmap.png")
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 3,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
b <- read.delim('GSEA_ranked_gene_list.txt',header = T,sep = '\t')
gene <- b[1:200,]
exprs <- read.csv('all.csv')
exprs <- exprs[,c(2:10)]
data_heatmap <- merge(exprs,gene,by.x = 'Other.Gene.ID',by.y = 'NAME',all = F)
data_heatmap <- data_heatmap[,1:9]
rownames(data_heatmap)<-data_heatmap$Other.Gene.ID
data_heatmap <- data_heatmap[,-1]
colnames(data_heatmap)<-c('FK2','FK4','FK5',paste0(rep('HN',5),1:5))
library(pheatmap)
library(RColorBrewer)
pdf("heatmap.pdf",width = 7,height = 20,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 3,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
pdf("heatmap.pdf",width = 7,height = 10,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 3,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
dev.off()
dev.off()
pdf("heatmap.pdf",width = 7,height = 10,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 3,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
b <- read.delim('GSEA_ranked_gene_list.txt',header = T,sep = '\t')
gene <- b[18338,18537]
exprs <- read.csv('all.csv')
exprs <- exprs[,c(2:10)]
data_heatmap <- merge(exprs,gene,by.x = 'Other.Gene.ID',by.y = 'NAME',all = F)
data_heatmap <- data_heatmap[,1:9]
rownames(data_heatmap)<-data_heatmap$Other.Gene.ID
data_heatmap <- data_heatmap[,-1]
colnames(data_heatmap)<-c('FK2','FK4','FK5',paste0(rep('HN',5),1:5))
library(pheatmap)
library(RColorBrewer)
pdf("heatmap_2.pdf",width = 7,height = 10,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 3,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
b <- read.delim('GSEA_ranked_gene_list.txt',header = T,sep = '\t')
gene <- b[18338:18537,]
exprs <- read.csv('all.csv')
exprs <- exprs[,c(2:10)]
data_heatmap <- merge(exprs,gene,by.x = 'Other.Gene.ID',by.y = 'NAME',all = F)
data_heatmap <- data_heatmap[,1:9]
rownames(data_heatmap)<-data_heatmap$Other.Gene.ID
data_heatmap <- data_heatmap[,-1]
colnames(data_heatmap)<-c('FK2','FK4','FK5',paste0(rep('HN',5),1:5))
library(pheatmap)
library(RColorBrewer)
pdf("heatmap_2.pdf",width = 7,height = 10,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 3,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
b <- read.delim('GSEA_ranked_gene_list.txt',header = T,sep = '\t')
gene <- b[18338:18537,]
exprs <- read.csv('all.csv')
exprs <- exprs[,c(2:10)]
data_heatmap <- merge(exprs,gene,by.x = 'Other.Gene.ID',by.y = 'NAME',all = F)
data_heatmap <- data_heatmap[,1:9]
rownames(data_heatmap)<-data_heatmap$Other.Gene.ID
data_heatmap <- data_heatmap[,-1]
colnames(data_heatmap)<-c('FK2','FK4','FK5',paste0(rep('HN',5),1:5))
library(pheatmap)
library(RColorBrewer)
pdf("heatmap.pdf",width = 7,height = 10,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 3,fontsize = 8,
main = 'TOP200(UP/DOWN)')
dev.off()
pdf("heatmap.pdf",width = 7,height = 10,onefile = T)
par(mar=c(5.1, 4.1, 4.1, 2.1))
map <-pheatmap(data_heatmap,col = colorRampPalette(c("blue","white","red"))(100),
scale = "row",
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = "euclidean",
clustering_distance_cols = "euclidean",
clustering_method = "complete",
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 3,fontsize = 8,
main = 'TOP200(UP in HN)')
dev.off()

tmp <- MySplit(i)
sig_genes <- c(sig_genes,tmp)
}
sig_genes <- unique(sig_genes)
sig_genes_tmp <- ego@result
sig_genes_tmp <- sig_genes_tmp[sig_genes_tmp$p.adjust<0.05,]
MySplit <- function(i){
tmp <- sig_genes_tmp[i,'geneID'] %>% str_split(pattern = '/') %>% unlist(recursive = T)
return(tmp)
}
sig_genes <- vector()
for (i in 1:nrow(sig_genes_tmp)) {
tmp <- MySplit(i)
sig_genes <- c(sig_genes,tmp)
}
sig_genes <- unique(sig_genes)
cat(sig_genes,sep = '\n')#按行打印出来，可以直接复制到stringDB里面做蛋白相互作用
load('Data.Rdata')
head(upgenes)
##1.制作表达文件gct格式
GSEA_exp_file <- background_all
colnames(GSEA_exp_file)
head(GSEA_exp_file)
GSEA_exp_file <- GSEA_exp_file[,c(12,2:11)]
head(GSEA_exp_file)
colnames(GSEA_exp_file)
colnames(GSEA_exp_file)[1] <- 'Symbol'
head(GSEA_exp_file)
index <- grep('BGI',GSEA_exp_file$Symbol)#Filter our BGI novel genes.
GSEA_exp_file <- GSEA_exp_file[-index,]
head(GSEA_exp_file)
#按照GSEA格式要求，给GSEA需要的矩阵添加第二列description,虽然会被GSEA忽略，
#但是需要添加这一列。先判断探针注释文件行数和gsea矩阵行数是否相同：
GSEA_exp_file$DESCRIPTION <- rep('NA',nrow(GSEA_exp_file))
head(GSEA_exp_file)
GSEA_exp_file <- background_all
colnames(GSEA_exp_file)
GSEA_exp_file <- GSEA_exp_file[,c(12,2:11)]
colnames(GSEA_exp_file)[1] <- 'Symbol'
index <- grep('BGI',GSEA_exp_file$Symbol)#Filter our BGI novel genes.
GSEA_exp_file <- GSEA_exp_file[-index,]
head(GSEA_exp_file)
#按照GSEA格式要求，给GSEA需要的矩阵添加第二列description,虽然会被GSEA忽略，
#但是需要添加这一列。先判断探针注释文件行数和gsea矩阵行数是否相同：
library(tibble)
add_column(GSEA_exp_file,rep('NA',nrow(GSEA_exp_file)),.before = 2)
#按照GSEA格式要求，给GSEA需要的矩阵添加第二列description,虽然会被GSEA忽略，
#但是需要添加这一列。先判断探针注释文件行数和gsea矩阵行数是否相同：
library(tibble)
head(GSEA_exp_file)
add_column(GSEA_exp_file,rep('NA',DESCRIPTION=nrow(GSEA_exp_file)),.before = 2)
GSEA_exp_file <- add_column(GSEA_exp_file,DESCRIPTION=rep('NA',nrow(GSEA_exp_file)),.before = 2)
head(GSEA_exp_file)
#手动添加前两行，如下：
#    #1.2     前面的“#”不能省略,这里总是#1.2
#    54675	50    分别为gene number，样本数. Tab-delimited
GSEA_exp_file <- add_row(.data = GSEA_exp_file,'#1.2',.before = 1)
#手动添加前两行，如下：
#    #1.2     前面的“#”不能省略,这里总是#1.2
#    54675	50    分别为gene number，样本数. Tab-delimited
GSEA_exp_file <- add_row(.data = GSEA_exp_file,'#1.2'='',.before = 1)
#手动添加前两行，如下：
#    #1.2     前面的“#”不能省略,这里总是#1.2
#    54675	50    分别为gene number，样本数. Tab-delimited
fix(GSEA_exp_file)
#手动添加前两行，如下：
#    #1.2     前面的“#”不能省略,这里总是#1.2
#    54675	50    分别为gene number，样本数. Tab-delimited
write.table(GSEA_exp_file,'GSEA_expression.gct',row.names = F,col.names = T,
quote = F,sep = '\t')
#手动添加前两行，如下：
#    #1.2     前面的“#”不能省略,这里总是#1.2
#    54675	50    分别为gene number，样本数. Tab-delimited
dim(GSEA_exp_file)
colnames(GSEA_exp_file)
##2.制作分组文件，cls格式
#格式如下所示：第一行50代表样本数目，2代表分2组，空格间隔，1照抄；
#第二行井号注释说明分组信息，空格间隔；第三行为每个样本对应的组名，空格分隔
#  50 2 1
#  # tumor benign
#  1	1	1	1	1	1	1	1	1	1	1	1	1	1	0	0	1	1	1	1	1	1	1	1	1	1	1	0	1	1	0	1	1	1	1	1	1	1	1	1	0	0	0	0	0	0	0	0	0	0
colnames(GSEA_exp_file)
# Fri Nov 16 15:44:08 2018 ------------------------------
rm(list=ls())
load('Data.Rdata')
index <- grep('BGI',upgenes$ï..Gene.ID)#Filter our BGI novel genes.
upgenes <- upgenes[-index,]
index <- grep('BGI',background_all$ï..Gene.ID)
background_all <- background_all[-index,]#filter out BGI_novel genes.
index <- grep('BGI',background_DEG$ï..Gene.ID)
background_DEG <- background_DEG[-index,]
entr_up <- as.vector(upgenes$ï..Gene.ID)
entr_bg <- as.vector(background_all$ï..Gene.ID)
library(clusterProfiler)
library(org.Hs.eg.db)
library(enrichplot)
#convert gene symbols to ENTREZID ID
#Attention: BGI report includes entrezID. No need to run the following 2 commands. Just filter out
#the BGI_novel genes.
#keytypes(org.Hs.eg.db)
#entr_up <- bitr(upgenes$Other.Gene.ID,fromType = 'SYMBOL',toType = c('ENTREZID','GENENAME'),OrgDb = 'org.Hs.eg.db')
#The ID type (both fromType & toType) should be one of ‘kegg’, ‘ncbi-geneid’, ‘ncbi-proteinid’ or
#‘uniprot’. The ‘kegg’ is the primary ID used in KEGG database. The data source of KEGG was from NCBI.
#A rule of thumb for the ‘kegg’ ID is entrez ID for eukaryote species and Locus ID for prokaryotes.
#keg2np <- bitr_kegg(entr_up$ENTREZID,fromType = 'kegg',toType = 'ncbi-proteinid',organism = 'hsa')
#head(keg2np)
#GO analysis
#GO classification/GoupGO 分析
ggo <- groupGO(gene = entr_up,OrgDb = org.Hs.eg.db,ont = 'BP',level = 3,keyType = 'ENTREZID',readable = T)
# Fri Nov 16 15:44:08 2018 ------------------------------
rm(list=ls())
load('Data.Rdata')
index <- grep('BGI',upgenes$ï..Gene.ID)#Filter our BGI novel genes.
upgenes <- upgenes[-index,]
index <- grep('BGI',background_all$ï..Gene.ID)
background_all <- background_all[-index,]#filter out BGI_novel genes.
index <- grep('BGI',background_DEG$ï..Gene.ID)
background_DEG <- background_DEG[-index,]
entr_up <- as.vector(upgenes$ï..Gene.ID)
entr_bg <- as.vector(background_all$ï..Gene.ID)
library(clusterProfiler)
library(org.Hs.eg.db)
library(enrichplot)
entr_up
upgenes
write.table(entr_up,'upgene.txt',quote = F,sep = '\t',row.names = F,col.names = F)
data <- read.csv('all')
data <- read.csv('all.csv')
data <- read.csv('all.csv')
View(data)
colnames(data)
data <- data[,2:11]
head(data)
library(Hmisc)
res <- rcorr(as.matrix(data))
library(pheatmap)
pheatmap(res$r,
col = colorRampPalette(c("blue","white","red"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("blue","white","red"))(3),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("lightblue","white","lightred"))(3),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("lightblue","white","red"))(3),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#3333FF","white","FF3333"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#3333FF","white","#FF3333"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#3333FF","white","#FF3333"))(10),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#3333FF","white","#FF3333"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#3333FF","white","#FF3333"))(1000),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#3333FF","white","#FF3333"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#3333FF","white","#EE4000	"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#3333FF","white","#EE4000"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#1E90FF","white","#EE4000"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#1E90FF","white","#EE9572"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#C6E2FF","white","#EE9572"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#87CEFF","white","#EE9572"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#87CEFF","white","#EE4000"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#87CEFF","white","#FFA500"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#87CEFF","white","#FF9933"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#87CEFF","white","#FF3333"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#87CEFF","white","#FF9999"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("blue","white","red"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pheatmap(res$r,
col = colorRampPalette(c("#3399FF","white","red"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
library(corrplot)
corrplot(res$r,type='full',order='hclust',tl.col = "black",
diag=T,outline = T,bg = 'white',addgrid.col = 'black',
addCoef.col = 'black',tl.cex = 1,
p.mat = res$P,sig.level = 0.01,insig = 'blank',
number.digits = 2)
corrplot(res$r,col = colorRampPalette(c("blue","white","red"))(100),
type='full',order='hclust',tl.col = "black",
diag=T,outline = T,bg = 'white',addgrid.col = 'black',
addCoef.col = 'black',tl.cex = 1,
p.mat = res$P,sig.level = 0.01,insig = 'blank',
number.digits = 2)
symnum(res$r)
pdf('Correlation_plot.pdf')
pheatmap(res$r,
col = colorRampPalette(c("#3399FF","white","red"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
dev.off()
dev.off()
pdf('Correlation_plot.pdf')
pheatmap(res$r,
col = colorRampPalette(c("#3399FF","white","red"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
dev.off()
pdf('Correlation_plot.pdf')
pheatmap(res$r,
col = colorRampPalette(c("#3399FF","white","red"))(100),
cluster_rows = F,cluster_cols=F,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
library(corrplot)
corrplot(res$r,col = colorRampPalette(c("blue","white","red"))(100),
type='full',order='hclust',tl.col = "black",
diag=T,outline = T,bg = 'white',addgrid.col = 'black',
addCoef.col = 'black',tl.cex = 1,
p.mat = res$P,sig.level = 0.01,insig = 'blank',
number.digits = 2)
print(symnum(res$r))
dev.off()
print(symnum(res$r))
symnum(res$r)
pheatmap(res$r,
col = colorRampPalette(c("#3399FF","white","red"))(100),
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = 'correlation',clustering_distance_cols = 'correlation',
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
data <- read.csv('all.csv')
data <- data[,2:11]
library(Hmisc)
res <- rcorr(as.matrix(data))
pdf('Correlation_plot',onefile = T)
library(pheatmap)
pheatmap(res$r,
col = colorRampPalette(c("#3399FF","white","red"))(100),
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = 'correlation',clustering_distance_cols = 'correlation',
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
library(corrplot)
corrplot(res$r,col = colorRampPalette(c("blue","white","red"))(100),
type='full',order='hclust',tl.col = "black",
diag=T,outline = T,bg = 'white',addgrid.col = 'black',
addCoef.col = 'black',tl.cex = 1,
p.mat = res$P,sig.level = 0.01,insig = 'blank',
number.digits = 2)
symnum(res$r)
dev.off()
pheatmap(res$r,
col = colorRampPalette(c("#3399FF","white","red"))(100),
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = 'correlation',clustering_distance_cols = 'correlation',treeheight_row = 80,treeheight_col = 80,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
pdf('Correlation_plot',onefile = T)
library(pheatmap)
pheatmap(res$r,
col = colorRampPalette(c("#3399FF","white","red"))(100),
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = 'correlation',clustering_distance_cols = 'correlation',
treeheight_row = 80,treeheight_col = 80,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
library(corrplot)
corrplot(res$r,col = colorRampPalette(c("blue","white","red"))(100),
type='full',order='hclust',tl.col = "black",
diag=T,outline = T,bg = 'white',addgrid.col = 'black',
addCoef.col = 'black',tl.cex = 1,
p.mat = res$P,sig.level = 0.01,insig = 'blank',
number.digits = 2)
symnum(res$r)
dev.off()
pdf('Correlation_plot.pdf',onefile = T)
library(pheatmap)
pheatmap(res$r,
col = colorRampPalette(c("#3399FF","white","red"))(100),
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = 'correlation',clustering_distance_cols = 'correlation',
treeheight_row = 80,treeheight_col = 80,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
library(corrplot)
corrplot(res$r,col = colorRampPalette(c("blue","white","red"))(100),
type='full',order='hclust',tl.col = "black",
diag=T,outline = T,bg = 'white',addgrid.col = 'black',
addCoef.col = 'black',tl.cex = 1,
p.mat = res$P,sig.level = 0.01,insig = 'blank',
number.digits = 2)
symnum(res$r)
dev.off()
dev.off()
pdf('Correlation_plot.pdf',onefile = T)
library(pheatmap)
pheatmap(res$r,
col = colorRampPalette(c("#3399FF","white","red"))(100),
cluster_rows = T,cluster_cols=T,
clustering_distance_rows = 'correlation',clustering_distance_cols = 'correlation',
treeheight_row = 80,treeheight_col = 80,
display_numbers = T,number_color = 'black',fontsize_number = 10,
border_color = NA,legend=TRUE,
show_colnames=T,show_rownames=T,
fontsize_col = 10,
fontsize_row = 10,fontsize = 10,
main = 'Correlation')
library(corrplot)
corrplot(res$r,col = colorRampPalette(c("blue","white","red"))(100),
type='full',order='hclust',tl.col = "black",
diag=T,outline = T,bg = 'white',addgrid.col = 'black',
addCoef.col = 'black',tl.cex = 1,
p.mat = res$P,sig.level = 0.01,insig = 'blank',
number.digits = 2)
symnum(res$r)
dev.off()
